-- 1) Go back to the dvdrental database, and get the average, standard deviation, and count
-- of each customer's lifetime spending. (This is a lot like yesterday's warmup).

*** QUERY ***

WITH spend_per_customer AS (
    SELECT customer_id, SUM(amount) as total_spent
    FROM payment
    GROUP BY customer_id
)

SELECT COUNT(total_spent), AVG(total_spent),stddev_samp(total_spent)
FROM spend_per_customer;


*** RESULT ***

 count |         avg          |     stddev_samp
-------+----------------------+---------------------
   599 | 102.3573288814691152 | 25.2321195449925139



-- 2) Your boss is absolutely certain (like 99%) that his new marketing strategy will increase
-- average customer spending by more than 10%, making the company an extra $100,000+ next year.
-- This is based on the fact that our company has about 10,000 customers, and his assumption
-- is that each customer is currently worth at least $100 in yearly spending. 
-- Your boss has already made this promise to the CEO.

-- Given our data (which is only a sample out of all of our customers), and that we want to be 99%
-- confident that our plan is going to work, we want compelling evidence that the TRUE customer 
-- average spending per year is more than $100. 
-- (USE at least 2 significant digits for your analysis)

-- Is the plan going to work? 
-- If not at 99% confidence, what about 95%?
-- If yes at 99%, what about 99.5%?
-- At which level of confidence can he tell the CEO that the plan is going to work?

-- BONUS:
-- If you still have time, get the count, average, and standard deviation of customer spending
-- for each store. Can you set up a hypothesis test to say if there's a statistically meaningful
-- difference between the two stores? Check chapter 12.